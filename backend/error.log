{"level":"error","message":"Error in sendMessage: Inngest API Error: 401 Event key not found","stack":"Error: Inngest API Error: 401 Event key not found\n    at Inngest.getResponseError (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:386:12)\n    at body.maxAttempts.maxAttempts (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:688:28)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async retryWithBackoff (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/helpers/promises.ts:247:14)\n    at async Inngest._send (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:667:18)\n    at async sendMessage (/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts:107:9)","timestamp":"2025-09-01T18:01:50.016Z"}
{"level":"error","message":"Error in sendMessage: Inngest API Error: 401 Event key not found","stack":"Error: Inngest API Error: 401 Event key not found\n    at Inngest.getResponseError (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:386:12)\n    at body.maxAttempts.maxAttempts (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:688:28)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async retryWithBackoff (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/helpers/promises.ts:247:14)\n    at async Inngest._send (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:667:18)\n    at async sendMessage (/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts:107:9)","timestamp":"2025-09-01T18:02:03.678Z"}
{"level":"error","message":"Error in sendMessage: Inngest API Error: 401 Event key not found","stack":"Error: Inngest API Error: 401 Event key not found\n    at Inngest.getResponseError (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:386:12)\n    at body.maxAttempts.maxAttempts (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:688:28)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async retryWithBackoff (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/helpers/promises.ts:247:14)\n    at async Inngest._send (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:667:18)\n    at async sendMessage (/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts:107:9)","timestamp":"2025-09-01T18:06:59.615Z"}
{"level":"error","message":"Error in sendMessage: Inngest API Error: 401 Event key not found","stack":"Error: Inngest API Error: 401 Event key not found\n    at Inngest.getResponseError (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:386:12)\n    at body.maxAttempts.maxAttempts (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:688:28)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async retryWithBackoff (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/helpers/promises.ts:247:14)\n    at async Inngest._send (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:667:18)\n    at async sendMessage (/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts:107:9)","timestamp":"2025-09-01T18:07:09.957Z"}
{"level":"error","message":"Error in sendMessage: Inngest API Error: 401 Event key not found","stack":"Error: Inngest API Error: 401 Event key not found\n    at Inngest.getResponseError (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:386:12)\n    at body.maxAttempts.maxAttempts (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:688:28)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async retryWithBackoff (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/helpers/promises.ts:247:14)\n    at async Inngest._send (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:667:18)\n    at async sendMessage (/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts:107:9)","timestamp":"2025-09-01T18:33:17.330Z"}
{"level":"error","message":"Error in sendMessage: Inngest API Error: 401 Event key not found","stack":"Error: Inngest API Error: 401 Event key not found\n    at Inngest.getResponseError (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:386:12)\n    at body.maxAttempts.maxAttempts (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:688:28)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async retryWithBackoff (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/helpers/promises.ts:247:14)\n    at async Inngest._send (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:667:18)\n    at async sendMessage (/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts:107:9)","timestamp":"2025-09-01T18:33:27.660Z"}
{"level":"error","message":"Error in sendMessage: Inngest API Error: 401 Event key not found","stack":"Error: Inngest API Error: 401 Event key not found\n    at Inngest.getResponseError (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:386:12)\n    at body.maxAttempts.maxAttempts (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:688:28)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async retryWithBackoff (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/helpers/promises.ts:247:14)\n    at async Inngest._send (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:667:18)\n    at async sendMessage (/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts:107:9)","timestamp":"2025-09-01T18:33:38.948Z"}
{"level":"error","message":"Error in sendMessage: Inngest API Error: 401 Event key not found","stack":"Error: Inngest API Error: 401 Event key not found\n    at Inngest.getResponseError (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:386:12)\n    at body.maxAttempts.maxAttempts (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:688:28)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async retryWithBackoff (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/helpers/promises.ts:247:14)\n    at async Inngest._send (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:667:18)\n    at async sendMessage (/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts:107:9)","timestamp":"2025-09-01T18:33:47.562Z"}
{"level":"error","message":"Error in sendMessage: Inngest API Error: 401 Event key not found","stack":"Error: Inngest API Error: 401 Event key not found\n    at Inngest.getResponseError (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:386:12)\n    at body.maxAttempts.maxAttempts (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:688:28)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async retryWithBackoff (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/helpers/promises.ts:247:14)\n    at async Inngest._send (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/Inngest.ts:667:18)\n    at async sendMessage (/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts:107:9)","timestamp":"2025-09-01T18:34:00.312Z"}
{"level":"error","message":"Error in sendMessage: Cannot read properties of undefined (reading 'models')","stack":"TypeError: Cannot read properties of undefined (reading 'models')\n    at sendMessage (/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts:125:38)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-09-01T19:36:32.021Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error in message analysis: hello","timestamp":"2025-09-01T19:36:32.189Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error generating response: hello","timestamp":"2025-09-01T19:36:32.456Z"}
{"level":"error","message":"Error in therapy session analysis: {\"error\":{\"code\":400,\"message\":\"API key not valid. Please pass a valid API key.\",\"status\":\"INVALID_ARGUMENT\",\"details\":[{\"@type\":\"type.googleapis.com/google.rpc.ErrorInfo\",\"reason\":\"API_KEY_INVALID\",\"domain\":\"googleapis.com\",\"metadata\":{\"service\":\"generativelanguage.googleapis.com\"}},{\"@type\":\"type.googleapis.com/google.rpc.LocalizedMessage\",\"locale\":\"en-US\",\"message\":\"API key not valid. Please pass a valid API key.\"}]}}","name":"Error","stack":"ApiError: {\"error\":{\"code\":400,\"message\":\"API key not valid. Please pass a valid API key.\",\"status\":\"INVALID_ARGUMENT\",\"details\":[{\"@type\":\"type.googleapis.com/google.rpc.ErrorInfo\",\"reason\":\"API_KEY_INVALID\",\"domain\":\"googleapis.com\",\"metadata\":{\"service\":\"generativelanguage.googleapis.com\"}},{\"@type\":\"type.googleapis.com/google.rpc.LocalizedMessage\",\"locale\":\"en-US\",\"message\":\"API key not valid. Please pass a valid API key.\"}]}}\n    at throwErrorIfNotOK (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/@google/genai/dist/node/index.cjs:13977:30)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/@google/genai/dist/node/index.cjs:13753:13\n    at async Models.generateContent (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/@google/genai/dist/node/index.cjs:15021:24)\n    at async /Users/rahuljoshi/Downloads/therapist_ai/backend/src/inngest/aiFunctions.ts:187:34\n    at async V1InngestExecution.tryExecuteStep (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/execution/v1.ts:276:14)\n    at async steps-found (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/execution/v1.ts:200:28)\n    at async V1InngestExecution._start (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/execution/v1.ts:147:24)\n    at async InngestCommHandler.handleAction (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/components/InngestCommHandler.ts:1126:28)\n    at async ServerTiming.wrap (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/src/helpers/ServerTiming.ts:82:15)","stepId":"analyze-with-gemini","timestamp":"2025-09-01T19:38:22.051Z"}
{"code":"ERR_MODULE_NOT_FOUND","level":"error","message":"Error in sendMessage: Cannot find module '/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.mjs' imported from /Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts","stack":"Error: Cannot find module '/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.mjs' imported from /Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts\n    at finalizeResolution (node:internal/modules/esm/resolve:275:11)\n    at moduleResolve (node:internal/modules/esm/resolve:932:10)\n    at defaultResolve (node:internal/modules/esm/resolve:1056:11)\n    at ModuleLoader.defaultResolve (node:internal/modules/esm/loader:654:12)\n    at ModuleLoader.#cachedDefaultResolve (node:internal/modules/esm/loader:603:25)\n    at ModuleLoader.resolve (node:internal/modules/esm/loader:586:38)\n    at ModuleLoader.getModuleJobForImport (node:internal/modules/esm/loader:242:38)\n    at onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:546:36)\n    at TracingChannel.tracePromise (node:diagnostics_channel:344:14)\n    at ModuleLoader.import (node:internal/modules/esm/loader:545:21)","timestamp":"2025-09-01T19:39:40.094Z","url":"file:///Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.mjs"}
{"code":"ERR_UNKNOWN_FILE_EXTENSION","level":"error","message":"Error in sendMessage: Unknown file extension \".mts\" for /Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.mts","stack":"TypeError: Unknown file extension \".mts\" for /Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.mts\n    at Object.getFileProtocolModuleFormat [as file:] (node:internal/modules/esm/get_format:219:9)\n    at defaultGetFormat (node:internal/modules/esm/get_format:245:36)\n    at defaultLoad (node:internal/modules/esm/load:120:22)\n    at async ModuleLoader.loadAndTranslate (node:internal/modules/esm/loader:483:32)\n    at async ModuleJob._link (node:internal/modules/esm/module_job:115:19)","timestamp":"2025-09-01T19:54:46.075Z"}
{"code":"ERR_UNKNOWN_FILE_EXTENSION","level":"error","message":"Error in sendMessage: Unknown file extension \".mts\" for /Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.mts","stack":"TypeError: Unknown file extension \".mts\" for /Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.mts\n    at Object.getFileProtocolModuleFormat [as file:] (node:internal/modules/esm/get_format:219:9)\n    at defaultGetFormat (node:internal/modules/esm/get_format:245:36)\n    at defaultLoad (node:internal/modules/esm/load:120:22)\n    at async ModuleLoader.loadAndTranslate (node:internal/modules/esm/loader:483:32)\n    at async ModuleJob._link (node:internal/modules/esm/module_job:115:19)","timestamp":"2025-09-01T19:54:57.781Z"}
{"code":"ERR_MODULE_NOT_FOUND","level":"error","message":"Error in sendMessage: Cannot find module '/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.js' imported from /Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts","stack":"Error: Cannot find module '/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.js' imported from /Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts\n    at finalizeResolution (node:internal/modules/esm/resolve:275:11)\n    at moduleResolve (node:internal/modules/esm/resolve:932:10)\n    at defaultResolve (node:internal/modules/esm/resolve:1056:11)\n    at ModuleLoader.defaultResolve (node:internal/modules/esm/loader:654:12)\n    at ModuleLoader.#cachedDefaultResolve (node:internal/modules/esm/loader:603:25)\n    at ModuleLoader.resolve (node:internal/modules/esm/loader:586:38)\n    at ModuleLoader.getModuleJobForImport (node:internal/modules/esm/loader:242:38)\n    at onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:546:36)\n    at TracingChannel.tracePromise (node:diagnostics_channel:344:14)\n    at ModuleLoader.import (node:internal/modules/esm/loader:545:21)","timestamp":"2025-09-01T19:56:28.658Z","url":"file:///Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.js"}
{"code":"ERR_MODULE_NOT_FOUND","level":"error","message":"Error in sendMessage: Cannot find module '/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.mjs' imported from /Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts","stack":"Error: Cannot find module '/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.mjs' imported from /Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts\n    at finalizeResolution (node:internal/modules/esm/resolve:275:11)\n    at moduleResolve (node:internal/modules/esm/resolve:932:10)\n    at defaultResolve (node:internal/modules/esm/resolve:1056:11)\n    at ModuleLoader.defaultResolve (node:internal/modules/esm/loader:654:12)\n    at ModuleLoader.#cachedDefaultResolve (node:internal/modules/esm/loader:603:25)\n    at ModuleLoader.resolve (node:internal/modules/esm/loader:586:38)\n    at ModuleLoader.getModuleJobForImport (node:internal/modules/esm/loader:242:38)\n    at onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:546:36)\n    at TracingChannel.tracePromise (node:diagnostics_channel:344:14)\n    at ModuleLoader.import (node:internal/modules/esm/loader:545:21)","timestamp":"2025-09-01T20:01:19.748Z","url":"file:///Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.mjs"}
{"code":"ERR_MODULE_NOT_FOUND","level":"error","message":"Error in sendMessage: Cannot find module '/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.mjs' imported from /Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts","stack":"Error: Cannot find module '/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.mjs' imported from /Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts\n    at finalizeResolution (node:internal/modules/esm/resolve:275:11)\n    at moduleResolve (node:internal/modules/esm/resolve:932:10)\n    at defaultResolve (node:internal/modules/esm/resolve:1056:11)\n    at ModuleLoader.defaultResolve (node:internal/modules/esm/loader:654:12)\n    at ModuleLoader.#cachedDefaultResolve (node:internal/modules/esm/loader:603:25)\n    at ModuleLoader.resolve (node:internal/modules/esm/loader:586:38)\n    at ModuleLoader.getModuleJobForImport (node:internal/modules/esm/loader:242:38)\n    at onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:546:36)\n    at TracingChannel.tracePromise (node:diagnostics_channel:344:14)\n    at ModuleLoader.import (node:internal/modules/esm/loader:545:21)","timestamp":"2025-09-01T20:08:35.472Z","url":"file:///Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/genai.mjs"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error in message analysis: hi","timestamp":"2025-09-01T20:08:56.381Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error generating response: hi","timestamp":"2025-09-01T20:08:56.643Z"}
{"level":"error","message":"Error in sendMessage: Unexpected token '`', \"```json\n{\n\"... is not valid JSON","stack":"SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at sendMessage (/Users/rahuljoshi/Downloads/therapist_ai/backend/src/controllers/chat.ts:137:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-09-01T20:08:57.130Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error in message analysis: hello","timestamp":"2025-09-01T21:28:23.107Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error generating response: hello","timestamp":"2025-09-01T21:28:23.330Z"}
{"level":"error","message":"Failed to parse analysis JSON:","timestamp":"2025-09-01T21:28:23.576Z"}
{"_message":"ChatSession validation failed","errors":{"messages.0.metadata.analysis":{"kind":"string","message":"Cast to string failed for value \"{}\" (type Object) at path \"metadata.analysis\"","name":"CastError","path":"metadata.analysis","reason":null,"stringValue":"\"{}\"","value":{},"valueType":"Object"}},"level":"error","message":"Error in sendMessage: ChatSession validation failed: messages.0.metadata.analysis: Cast to string failed for value \"{}\" (type Object) at path \"metadata.analysis\"","stack":"ValidationError: ChatSession validation failed: messages.0.metadata.analysis: Cast to string failed for value \"{}\" (type Object) at path \"metadata.analysis\"\n    at model.Document.invalidate (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/document.js:3358:32)\n    at EmbeddedDocument.Subdocument.invalidate (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/types/subdocument.js:229:12)\n    at EmbeddedDocument.$set (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/document.js:1480:12)\n    at EmbeddedDocument.$set (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/document.js:1227:14)\n    at EmbeddedDocument.$set (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/document.js:1117:14)\n    at EmbeddedDocument.Document (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/document.js:178:12)\n    at EmbeddedDocument.Subdocument (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/types/subdocument.js:34:12)\n    at EmbeddedDocument.ArraySubdocument [as constructor] (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/types/arraySubdocument.js:44:15)\n    at new EmbeddedDocument (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/schema/documentArray.js:142:17)\n    at Proxy._cast (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/types/documentArray/methods/index.js:103:17)","timestamp":"2025-09-01T21:28:24.464Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error in message analysis: we","timestamp":"2025-09-01T21:28:42.458Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error generating response: we","timestamp":"2025-09-01T21:28:42.697Z"}
{"level":"error","message":"Failed to parse analysis JSON:","timestamp":"2025-09-01T21:28:43.212Z"}
{"_message":"ChatSession validation failed","errors":{"messages.0.metadata.analysis":{"kind":"string","message":"Cast to string failed for value \"{}\" (type Object) at path \"metadata.analysis\"","name":"CastError","path":"metadata.analysis","reason":null,"stringValue":"\"{}\"","value":{},"valueType":"Object"}},"level":"error","message":"Error in sendMessage: ChatSession validation failed: messages.0.metadata.analysis: Cast to string failed for value \"{}\" (type Object) at path \"metadata.analysis\"","stack":"ValidationError: ChatSession validation failed: messages.0.metadata.analysis: Cast to string failed for value \"{}\" (type Object) at path \"metadata.analysis\"\n    at model.Document.invalidate (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/document.js:3358:32)\n    at EmbeddedDocument.Subdocument.invalidate (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/types/subdocument.js:229:12)\n    at EmbeddedDocument.$set (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/document.js:1480:12)\n    at EmbeddedDocument.$set (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/document.js:1227:14)\n    at EmbeddedDocument.$set (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/document.js:1117:14)\n    at EmbeddedDocument.Document (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/document.js:178:12)\n    at EmbeddedDocument.Subdocument (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/types/subdocument.js:34:12)\n    at EmbeddedDocument.ArraySubdocument [as constructor] (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/types/arraySubdocument.js:44:15)\n    at new EmbeddedDocument (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/schema/documentArray.js:142:17)\n    at Proxy._cast (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/types/documentArray/methods/index.js:103:17)","timestamp":"2025-09-01T21:28:44.595Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error in message analysis: hello","timestamp":"2025-09-01T21:29:52.943Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error generating response: hello","timestamp":"2025-09-01T21:29:53.197Z"}
{"level":"error","message":"Failed to parse analysis JSON:","timestamp":"2025-09-01T21:29:53.673Z"}
{"_message":"ChatSession validation failed","errors":{"messages.0.metadata.analysis":{"kind":"string","message":"Cast to string failed for value \"{}\" (type Object) at path \"metadata.analysis\"","name":"CastError","path":"metadata.analysis","reason":null,"stringValue":"\"{}\"","value":{},"valueType":"Object"}},"level":"error","message":"Error in sendMessage: ChatSession validation failed: messages.0.metadata.analysis: Cast to string failed for value \"{}\" (type Object) at path \"metadata.analysis\"","stack":"ValidationError: ChatSession validation failed: messages.0.metadata.analysis: Cast to string failed for value \"{}\" (type Object) at path \"metadata.analysis\"\n    at model.Document.invalidate (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/document.js:3358:32)\n    at EmbeddedDocument.Subdocument.invalidate (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/types/subdocument.js:229:12)\n    at EmbeddedDocument.$set (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/document.js:1480:12)\n    at EmbeddedDocument.$set (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/document.js:1227:14)\n    at EmbeddedDocument.$set (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/document.js:1117:14)\n    at EmbeddedDocument.Document (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/document.js:178:12)\n    at EmbeddedDocument.Subdocument (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/types/subdocument.js:34:12)\n    at EmbeddedDocument.ArraySubdocument [as constructor] (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/types/arraySubdocument.js:44:15)\n    at new EmbeddedDocument (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/schema/documentArray.js:142:17)\n    at Proxy._cast (/Users/rahuljoshi/Downloads/therapist_ai/backend/node_modules/mongoose/lib/types/documentArray/methods/index.js:103:17)","timestamp":"2025-09-01T21:29:54.416Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error in message analysis: hello","timestamp":"2025-09-01T21:41:58.965Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error generating response: hello","timestamp":"2025-09-01T21:41:59.361Z"}
{"level":"error","message":"Failed to parse analysis JSON:","timestamp":"2025-09-01T21:42:00.157Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error in message analysis: how do i get better at work life balance","timestamp":"2025-09-01T21:42:20.528Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error generating response: how do i get better at work life balance","timestamp":"2025-09-01T21:42:20.798Z"}
{"level":"error","message":"Failed to parse analysis JSON:","timestamp":"2025-09-01T21:42:21.477Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error in message analysis: how do i improve sleep","timestamp":"2025-09-01T21:43:53.464Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error generating response: how do i improve sleep","timestamp":"2025-09-01T21:43:53.783Z"}
{"level":"error","message":"Failed to parse analysis JSON:","timestamp":"2025-09-01T21:43:54.900Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error in message analysis: what about my emotional state","timestamp":"2025-09-01T21:44:18.437Z"}
{"error":{"name":"ApiError","status":400},"level":"error","message":"Error generating response: what about my emotional state","timestamp":"2025-09-01T21:44:18.692Z"}
{"level":"error","message":"Failed to parse analysis JSON:","timestamp":"2025-09-01T21:44:19.609Z"}
